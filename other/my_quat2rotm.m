function R = my_quat2rotm(q)
    % 将单位四元数转换为旋转矩阵
    a = q(:, 1);
    b = q(:, 2);
    c = q(:, 3);
    d = q(:, 4);

    R = zeros(3, 3, size(q, 1));

    R(1, 1, :) = 1 - 2*c.^2 - 2*d.^2;
    R(1, 2, :) = 2*(b.*c - a.*d);
    R(1, 3, :) = 2*(a.*c + b.*d);

    R(2, 1, :) = 2*(b.*c + a.*d);
    R(2, 2, :) = 1 - 2*b.^2 - 2*d.^2;
    R(2, 3, :) = 2*(c.*d - a.*b);

    R(3, 1, :) = 2*(b.*d - a.*c);
    R(3, 2, :) = 2*(a.*b + c.*d);
    R(3, 3, :) = 1 - 2*b.^2 - 2*c.^2;
end


